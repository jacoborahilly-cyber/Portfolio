<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Interactive Canvas Portfolio</title>
    <style>
        /* CSS from previous steps */
        body { 
            overflow: hidden; 
            margin: 0; 
            padding: 0; 
            background-color: #121212; 
            font-family: Arial, sans-serif; 
            color: #E0E0E0;
        }

        #world { 
            position: absolute; 
            width: 5000px;      
            height: 5000px;     
            top: 0; 
            left: 0;
            background: 
                repeating-linear-gradient(0deg, #333 0, #333 1px, transparent 1px, transparent 100px),
                repeating-linear-gradient(-90deg, #333 0, #333 1px, transparent 1px, transparent 100px);
            background-size: 100px 100px;
        }
        
        .content-area, .room-content { 
            position: absolute; 
            width: 1000px;
            min-height: 700px;
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7); 
            color: #121212;
        }
        
        /* Room Styles */
        #Room-Design { top: 500px; left: 500px; background-color: #FF5A5F; }
        #Room-Code { top: 3500px; left: 3500px; background-color: #1ABC9C; }
        #Room-About { top: 2500px; left: 500px; background-color: #F39C12; }
        
        /* Instruction Panel CSS */
        #instruction-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            background-color: rgba(255, 255, 255, 0.95);
            color: #121212;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .hidden { opacity: 0 !important; pointer-events: none; }

        /* --- Indicator CSS (Re-added) --- */
        .indicator {
            position: fixed;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
            z-index: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5em;
            color: white;
            line-height: 0; /* Ensures the triangle sits in the middle */
            padding-top: 5px; 
        }
        .indicator.on-screen { opacity: 0; top: -100px; }
        .indicator.off-screen { opacity: 1; }

        /* Indicator Colors */
        #indicator-design { background-color: #FF5A5F; }
        #indicator-code { background-color: #1ABC9C; }
        #indicator-about { background-color: #F39C12; }
    </style>
</head>
<body>

    <div id="instruction-popup">
        Use **WASD** or **Arrow Keys** to explore the portfolio!
    </div>
    
    <div id="indicator-design" class="indicator on-screen"></div>
    <div id="indicator-code" class="indicator on-screen"></div>
    <div id="indicator-about" class="indicator on-screen"></div>

    <div id="world">
        <section id="Room-Design" class="room-content" data-target-x="500" data-target-y="500">
            <h2>ðŸŽ¨ Design Room</h2>
            <p>This space is dedicated to my **UX/UI case studies**...</p>
            <h3>Creative Design Showcase</h3>
            <div class="project-placeholder">Project 1 Placeholder (600px x 400px)</div>
            <div class="project-placeholder">Project 2 Placeholder (600px x 400px)</div>
            <div style="clear: both;"></div>
            <p>Coordinates: (500px, 500px)</p>
        </section>

        <section id="Room-Code" class="room-content" data-target-x="3500" data-target-y="3500">
            <h2>ðŸ’» Code Room</h2>
            <p>Here you can find my **front-end development** projects...</p>
            <h3>Technical Projects</h3>
            <ul>
                <li>**GitHub API Fetcher:**...</li>
                <li>**Interactive Data Visualization:**...</li>
                <li>**AI-Generated Art Tool:**...</li>
            </ul>
            <p>Coordinates: (3500px, 3500px)</p>
        </section>

        <section id="Room-About" class="room-content" data-target-x="500" data-target-y="2500"><h2>ðŸ‘¤ About Room</h2><p>Learn more about **who I am**...</p><p>Coordinates: (2500px, 500px) - NOTE: This room's Y is 2500px, X is 500px</p></section>

        <div id="spawn-center" style="position: absolute; top: 2500px; left: 2500px; width: 1px; height: 1px;"></div>
    </div>

    <script>
        const world = document.getElementById('world');
        const instructionPopup = document.getElementById('instruction-popup');
        
        // World Dimensions (5000px x 5000px)
        const WORLD_SIZE = 5000;
        const HALF_WORLD = WORLD_SIZE / 2;

        // Target/Current positions
        let targetX = 0;
        let targetY = 0;
        let currentX = 0;
        let currentY = 0;
        
        // --- MOVEMENT CONSTANTS (Simple Easing, No Bounce) ---
        const easing = 0.08; 
        
        // Acceleration Variables (for exponential speed)
        const baseSpeed = 0.5;      
        const maxSpeed = 15;        
        const accelerationRate = 1.05; 
        let currentSpeed = baseSpeed;

        // Key movement variables
        const keyMap = {};Â 
        
        // Room Data (Re-added for indicator logic)
        const rooms = [
            { id: 'Room-Design', element: document.getElementById('Room-Design'), indicator: document.getElementById('indicator-design'), center: { x: 500 + 500, y: 500 + 350 } },
            { id: 'Room-Code', element: document.getElementById('Room-Code'), indicator: document.getElementById('indicator-code'), center: { x: 3500 + 500, y: 3500 + 350 } },
            { id: 'Room-About', element: document.getElementById('Room-About'), indicator: document.getElementById('indicator-about'), center: { x: 500 + 500, y: 2500 + 350 } }
        ];

        // --- NEW: Initialization Function to Center the View ---
        function initializePosition() {
            // Get the center of the viewport
            const viewportCenterX = window.innerWidth / 2;
            const viewportCenterY = window.innerHeight / 2;
            
            // The world's absolute center is at (2500, 2500)
            // To make the world's center appear in the viewport's center, 
            // the world must be translated by (ViewportCenter - WorldCenter).
            
            // We want the viewport to be looking at (2500, 2500).
            // Since the canvas moves opposite to the user, the final translation should be:
            currentX = targetX = viewportCenterX - HALF_WORLD;
            currentY = targetY = viewportCenterY - HALF_WORLD;
            
            // Apply initial transform immediately
            world.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
        }

        // --- Keyboard Event Listeners (Unchanged) ---
        const movementKeys = ['KeyW', 'KeyA', 'KeyS', 'KeyD', 'ArrowUp', 'ArrowLeft', 'ArrowDown', 'ArrowRight'];

        window.addEventListener('keydown', (e) => {
            if (movementKeys.includes(e.code)) {
                if (!keyMap[e.code]) { currentSpeed = baseSpeed; }
                keyMap[e.code] = true;
                e.preventDefault();
                hideInstructions();
            }
        });

        window.addEventListener('keyup', (e) => {
            if (movementKeys.includes(e.code)) {
                keyMap[e.code] = false;
            }
            if (!Object.values(keyMap).some(v => v === true)) {
                 currentSpeed = baseSpeed;
            }
        });

        // --- Instruction Pop-up Logic (Unchanged) ---
        function hideInstructions() {
            if (!instructionPopup.classList.contains('hidden')) {
                instructionPopup.classList.add('hidden');
            }
        }
        setTimeout(hideInstructions, 4000);Â 

        // --- Indicator Update Function (Restored) ---
        function updateIndicators() {
            const viewportW = window.innerWidth;
            const viewportH = window.innerHeight;
            const viewportCenterX = viewportW / 2;
            const viewportCenterY = viewportH / 2;
            const indicatorSize = 40;Â 
            
            rooms.forEach(room => {
                const roomScreenX = currentX + room.center.x;
                const roomScreenY = currentY + room.center.y;
                
                // Simple visibility check
                const isVisibleX = roomScreenX > -(1000) && roomScreenX < viewportW + (1000);
                const isVisibleY = roomScreenY > -(700) && roomScreenY < viewportH + (700);
                const isVisible = isVisibleX && isVisibleY;
                
                if (isVisible) {
                    room.indicator.classList.add('on-screen');
                    room.indicator.classList.remove('off-screen');
                } else {
                    room.indicator.classList.remove('on-screen');
                    room.indicator.classList.add('off-screen');

                    const vecX = roomScreenX - viewportCenterX;
                    const vecY = roomScreenY - viewportCenterY;
                    const angle = Math.atan2(vecY, vecX);Â 
                    
                    let ix = viewportCenterX + Math.cos(angle) * viewportW;
                    let iy = viewportCenterY + Math.sin(angle) * viewportH;

                    const diagonalFactor = Math.abs(Math.cos(angle)) + Math.abs(Math.sin(angle));
                    ix = viewportCenterX + Math.cos(angle) * (viewportW / 2) / diagonalFactor;
                    iy = viewportCenterY + Math.sin(angle) * (viewportH / 2) / diagonalFactor;
                    
                    room.indicator.style.left = `${ix - indicatorSize / 2}px`;
                    room.indicator.style.top = `${iy - indicatorSize / 2}px`;
                    
                    room.indicator.style.transform = `rotate(${angle + Math.PI / 2}rad)`;
                    room.indicator.textContent = 'â–²';Â 
                }
            });
        }


        // --- Animation Loop (Linear Easing) ---
        function animate() {
            // 1. Acceleration
            if (Object.values(keyMap).some(v => v === true)) {
                currentSpeed = Math.min(maxSpeed, currentSpeed * accelerationRate);
            } else {
                currentSpeed = baseSpeed;Â 
            }

            // 2. Apply movement to the TARGET
            if (keyMap['KeyA'] || keyMap['ArrowLeft']) { targetX += currentSpeed; }
            if (keyMap['KeyD'] || keyMap['ArrowRight']) { targetX -= currentSpeed; }
            if (keyMap['KeyW'] || keyMap['ArrowUp']) { targetY += currentSpeed; }
            if (keyMap['KeyS'] || keyMap['ArrowDown']) { targetY -= currentSpeed; }
            
            // 3. Simple Easing (Deceleration)
            const dx = targetX - currentX;
            const dy = targetY - currentY;
            
            currentX += dx * easing;
            currentY += dy * easing;

            // 4. Apply the new position
            world.style.transform = `translate3d(${Math.round(currentX)}px, ${Math.round(currentY)}px, 0)`;

            updateIndicators();Â 

            window.requestAnimationFrame(animate);
        }

        // --- Start Execution ---
        window.onload = initializePosition; // Center the view when the window loads
        animate(); // Start the animation loop
    </script>
    
</body>
</html>
